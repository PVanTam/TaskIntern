# Tạo lab cho thực hành và thao tác với các công cụ pentest
>Tên tài liệu: Tạo lab cho thực hành và thao tác với các công cụ pentest <br>
Thực hiện: Phạm Văn Tam <br>
Cập nhật lần cuối: 30/09/2024
>
# Mục Lục
[1. Tạo lab thực hành](#p1) <br>
[2. Tìm hiểu một số công cụ ](#p2) <br>

# Nội dung:
<a id="p1"></a>
## 1. Tạo lab thực hành
Chúng ta sẽ tạo lab thực hành test các lỗ hổng với VulnLab <br>
Vulnlab có các lỗ hổng sau: <br>
![image](https://github.com/user-attachments/assets/0e864fee-2006-489a-ab60-b6c2827fc4f8)
Tiến hành setup:  <br>
- Clone the repo <br>
```
git clone https://github.com/Yavuzlar/VulnLab
```
- Build docker image: <br>
```
docker build -t yavuzlar/vulnlab .
```
- Run container : <br>
```
 docker run -d -p 1337:80 yavuzlar/vulnlab
```
Tiến hành check docker bằng lệnh `docker ps` để kiếm tra image đã chạy chưa <br>
![image](https://github.com/user-attachments/assets/cb15baba-f453-4e48-a499-c40d9c143f0e)
Và truy cập web : `http://ip:1337 <br>
![image](https://github.com/user-attachments/assets/a5b94c71-c1aa-41a4-b57d-b9b20fe3ab20)

<a id="p2"></a>
## 2. Tìm hiểu một số công cụ 
### 2.1 BurpSuite
BurpSuite là công cụ kiểm tra thâm nhập và tìm kiếm lỗ hổng <br>
Nó có các chức năng sau: <br>
**Dashboard:**
Hiển thị các công cụ và chức năng của BurpSuite
![image](https://github.com/user-attachments/assets/82c09f9a-2cd2-4f2a-a13a-04f3b6063f2a)
**Target** <br>
Chức năng: là nơi chứa các thông tin tổng quan về web. Cho phép xem site map và điều chỉnh phạm vi mục tiêu và có thể được xác định bằng cách điền loại giao thức, host/IP, port. Ngoài ra ở đây còn có thể chọn 2 option scan đó là passive scan và active scan <br>
![image](https://github.com/user-attachments/assets/34337305-b1f3-482b-869a-c99b89f56048)
**Proxy** <br>
Chức năng : Tab Proxy hiển thị chi tiết các request đi qua Burp Proxy. Tại đây, bạn có các tùy chọn Forward, Drop, Chỉnh sửa hay chuyển sang các action khác (repeater, intruder, etc...) <br>
![image](https://github.com/user-attachments/assets/536e57b2-2265-461e-b44f-cb31bcff7949)
**Intruder** <br>
Chức năng : ho phép test ứng dụng web bằng cách gửi các payloads đã được định nghĩa trước lên server, sau đó xem xét kết quả trả về. <br>
![image](https://github.com/user-attachments/assets/4dcbf6b2-e57a-4b33-92ad-30c7c4f76f8c)
**Repeater** <br>
Chức năng: Có thể tùy ý thay đổi và gửi lại những request khác nhau tới server. Đồng thời sẽ nhận về response từ server để có thể phân tích được gói tin. <br>
![image](https://github.com/user-attachments/assets/5e607d8b-f63e-4f86-aa4c-1bcc95096159)
**Collaborator** : Tính năng này cho phép bạn kiểm tra các lỗ hổng bảo mật phức tạp mà máy quét thông thường không thể phát hiện. Burp Collaborator giúp phát hiện các vấn đề như SSRF  <br>
![image](https://github.com/user-attachments/assets/caea059a-980b-457c-a587-c9ce7bb6e13e)
**Sequencer** <br>
Chức năng : Dùng để phân tích các token của ứng dụng <br>
![image](https://github.com/user-attachments/assets/31d2e55e-5f24-4094-bc58-5cfb838da13c)
**Decoder**
Chức năng : Dùng để encode, decode những thông tin mà người dùng nhập vào <br>
![image](https://github.com/user-attachments/assets/5c3c594c-cd81-42f2-9298-bcaacd8573a7)
**Comparer**
Chức năng:  Dùng để so sánh các request, response khác nhau (thông qua Proxy tab hoặc Target tab, bằng việc nhấn chuột phải vào request, và chọn "Sent to Comparer" <br>
![image](https://github.com/user-attachments/assets/42949d49-3518-478f-81fb-59f2d63352c4)
**Logger**
Chức năng: dùng để log lại tất cả các request được thực hiện trên Burp với Scan của Burp Pro
![image](https://github.com/user-attachments/assets/06668bbd-7227-43c0-becb-3c05256ee21a)
**Organizer**
Chức năng : Tạo ra các thư mục hoặc nhóm để quản lý các điểm kiểm thử, payloads và các phản hồi từ ứng dụng <br>
![image](https://github.com/user-attachments/assets/1a9e6de0-74db-467c-8533-17429165d4fc)
**Extension**
Chức năng : Là nới chứa các extension cho phép bạn thêm mới các extension có sẵn của Burp hoặc extension do bạn phát triển
![image](https://github.com/user-attachments/assets/bada7e55-237c-4ac2-8fc3-beebe5ad87a7)
### 2.2 SQL Map
SQLMap là một công cụ mã nguồn mở tự động hóa quá trình phát hiện và khai thác lỗ hổng SQL injection, một dạng lỗ hổng phổ biến trên các ứng dụng web <br>
Tính năng: <br>
- Hỗ trợ đầy đủ làm việc với các hệ quản trị cơ sở dữ liệu MySQL, Oracle, PostgreSQL, Microsoft SQL Server, Microsoft Access, IBM DB2, SQLite, Firebird, Sybase, SAP MaxDB, Informix, MariaDB, MemSQL, TiDB, CockroachDB, ...
- Hỗ trợ đầy đủ cho các kỹ thuật tấn công SQL Injection: boolean-based blind, time-based blind, error-based, UNION query-based, stacked queries và out-of-band
- Kết nối trực tiếp với cơ sở dữ liệu mà không cần thông qua SQL SQL, bằng cách cung cấp thông tin đăng nhập DBMS, địa chỉ IP, cổng và tên cơ sở dữ liệu.
- Liệt kê người dùng, password hash, đặc quyền, vai trò, cơ sở dữ liệu, bảng và cột.
- Tự động nhận dạng các định dạng băm mật khẩu và hỗ trợ bẻ khóa chúng bằng cách sử dụng một cuộc tấn công dựa trên từ điển.
- Trích xuất hoàn toàn các bảng cơ sở dữ liệu, một loạt các mục hoặc các cột cụ thể theo lựa chọn của người dùng
- Tìm kiếm tên cơ sở dữ liệu cụ thể, các bảng cụ thể trên tất cả các cơ sở dữ liệu hoặc các cột cụ thể trên tất cả các bảng của cơ sở dữ liệu
- Tải xuống và tải lên bất kỳ tệp nào từ máy chủ cơ sở dữ liệu bên dưới hệ thống tệp khi phần mềm cơ sở dữ liệu là MySQL, PostgreQuery hoặc Microsoft SQL Server.
- Thực hiện các lệnh tùy ý và truy xuất đầu ra tiêu chuẩn của chúng trên máy chủ cơ sở dữ liệu bên dưới hệ điều hành khi phần mềm cơ sở dữ liệu là MySQL, PostgreQuery hoặc Microsoft SQL Server <br>

Cách sử dụng cơ bản : <br>
1. Chạy lệnh cơ bản để kiểm tra lỗ hổng: <br>
```
sqlmap -u "target" --batch
```
Trong đó, -u là URL mục tiêu, --batch tự động chọn câu trả lời mặc định.
2. Xác định và dump cơ sở dữ liệu: <br>
```
sqlmap -u "target" --dbs
```
3. Dump bảng và cột từ cơ sở dữ liệu: <br>
```
sqlmap -u "target" -D tên_cơ_sở_dữ_liệu -T tên_bảng -C tên_cột --dump
```
Một vài tham số hữu ích : <br>
--risk và --level: Điều chỉnh độ rủi ro và mức độ thử nghiệm. Thường được sử dụng với --risk=3 và --level=5 để thử nghiệm nhiều hơn.
--tamper: Sử dụng với các tamper script để tránh bị phát hiện bởi WAF.
### 2.3 WPScan
WPScan là một công cụ mã nguồn mở được sử dụng để kiểm tra và đánh giá bảo mật các trang web WordPress. WPScan chuyên tìm kiếm các lỗ hổng bảo mật trên nền tảng WordPress, bao gồm các plugin, theme, và cả lỗi bảo mật của cốt lõi WordPress. <br>
Tính năng : <br>
- Quét các lỗ hổng phổ biến trên WordPress: WPScan có thể phát hiện các lỗ hổng đã được công khai của phiên bản WordPress, các plugin, và theme đang được sử dụng.
- Liệt kê các plugin và theme: Công cụ này có thể liệt kê tất cả các plugin và theme đang được cài đặt trên trang web, và kiểm tra xem chúng có bị ảnh hưởng bởi lỗ hổng bảo mật nào không.
- Kiểm tra thông tin người dùng: WPScan có khả năng tìm kiếm các tài khoản người dùng (username enumeration) đang tồn tại trên trang web, điều này có thể giúp kẻ tấn công thực hiện các cuộc tấn công dò mật khẩu.
- Kiểm tra mật khẩu yếu: WPScan có thể thực hiện các cuộc tấn công brute-force để dò mật khẩu của tài khoản quản trị WordPress, với danh sách mật khẩu phổ biến.
- Tích hợp cơ sở dữ liệu lỗ hổng WPVulnDB: Cơ sở dữ liệu này chứa thông tin về các lỗ hổng bảo mật đã biết của WordPress, plugin và theme, giúp WPScan cập nhật và kiểm tra chính xác các lỗ hổng mới. <br>

Cách sử dụng cơ bản : <br>
1. Quét phiên bản WordPress và kiểm tra các lỗ hổng: <br>
Lệnh này quét thông tin cơ bản của trang web WordPress, bao gồm phiên bản WordPress và các lỗ hổng đã biết. <br>
```
wpscan --url target
```
2. Liệt kê các plugin:
Tham số --enumerate p sẽ liệt kê tất cả các plugin đang được cài đặt. <br>
```
wpscan --url target --enumerate p
```
3. Liệt kê các theme:
```
wpscan --url target --enumerate t
```
4. Liệt kê người dùng:
```
wpscan --url target --enumerate u
```
5. Kiểm tra mật khẩu của người dùng:
```
wpscan --url target --passwords password_list.txt --usernames admin
```








